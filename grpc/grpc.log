2025-05-09T09:02:22.442+05:30 ERROR 38078 --- [grpc] [grpc-default-executor-0] io.grpc.internal.SerializingExecutor     : Exception while executing runnable io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed@7308186f

java.lang.ClassCastException: class reactor.core.publisher.FluxUsingWhen cannot be cast to class com.grpc.entity.Stock (reactor.core.publisher.FluxUsingWhen and com.grpc.entity.Stock are in unnamed module of loader 'app')
	at jdk.proxy2/jdk.proxy2.$Proxy65.findByStockSymbol(Unknown Source) ~[na:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
	at jdk.proxy2/jdk.proxy2.$Proxy65.findByStockSymbol(Unknown Source) ~[na:na]
	at com.grpc.service.StockTradingServiceImpl.getStockPrice(StockTradingServiceImpl.java:28) ~[classes/:na]
	at com.grpc.StockTradingServiceGrpc$MethodHandlers.invoke(StockTradingServiceGrpc.java:261) ~[classes/:na]
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182) ~[grpc-stub-1.72.0.jar:1.72.0]
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:356) ~[grpc-core-1.72.0.jar:1.72.0]
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:861) ~[grpc-core-1.72.0.jar:1.72.0]
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) ~[grpc-core-1.72.0.jar:1.72.0]
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133) ~[grpc-core-1.72.0.jar:1.72.0]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1575) ~[na:na]

2025-05-09T09:04:44.212+05:30  INFO 38078 --- [grpc] [SpringApplicationShutdownHook] o.s.g.s.lifecycle.GrpcServerLifecycle    : Completed gRPC server shutdown
2025-05-09T09:04:44.213+05:30  INFO 38078 --- [grpc] [SpringApplicationShutdownHook] o.s.b.w.embedded.netty.GracefulShutdown  : Commencing graceful shutdown. Waiting for active requests to complete
2025-05-09T09:04:44.214+05:30  INFO 38078 --- [grpc] [netty-shutdown] o.s.b.w.embedded.netty.GracefulShutdown  : Graceful shutdown complete
2025-05-09T09:04:52.160+05:30  INFO 39313 --- [grpc] [main] com.grpc.GrpcApplication                 : Starting GrpcApplication using Java 23.0.2 with PID 39313 (/Users/rishabhsharma/Downloads/grpc/target/classes started by rishabhsharma in /Users/rishabhsharma/Downloads/grpc)
2025-05-09T09:04:52.162+05:30  INFO 39313 --- [grpc] [main] com.grpc.GrpcApplication                 : No active profile set, falling back to 1 default profile: "default"
2025-05-09T09:04:52.390+05:30  INFO 39313 --- [grpc] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Reactive MongoDB repositories in DEFAULT mode.
2025-05-09T09:04:52.449+05:30  INFO 39313 --- [grpc] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 57 ms. Found 1 Reactive MongoDB repository interface.
2025-05-09T09:04:52.657+05:30  INFO 39313 --- [grpc] [main] org.mongodb.driver.client                : MongoClient with metadata {"driver": {"name": "mongo-java-driver|reactive-streams|spring-boot", "version": "5.2.1"}, "os": {"type": "Darwin", "name": "Mac OS X", "architecture": "aarch64", "version": "15.4.1"}, "platform": "Java/Amazon.com Inc./23.0.2+7-FR"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=null, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=null, transportSettings=NettyTransportSettings{eventLoopGroup=io.netty.channel.nio.NioEventLoopGroup@65bb6275, socketChannelClass=null, allocator=null, sslContext=null}, commandListeners=[], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, CollectionCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.client.model.mql.ExpressionCodecProvider@64da6cbd, com.mongodb.Jep395RecordCodecProvider@72a2312e, com.mongodb.KotlinCodecProvider@47c7a9e5]}, loggerSettings=LoggerSettings{maxDocumentLength=1000}, clusterSettings={hosts=[localhost:27017], srvServiceName=mongodb, mode=SINGLE, requiredClusterType=UNKNOWN, requiredReplicaSetName='null', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='15 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, proxySettings=ProxySettings{host=null, port=null, username=null, password=null}}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, proxySettings=ProxySettings{host=null, port=null, username=null, password=null}}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverMonitoringMode=AUTO, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=false, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, dnsClient=null, inetAddressResolver=null, contextProvider=null, timeoutMS=null}
2025-05-09T09:04:52.693+05:30  INFO 39313 --- [grpc] [cluster-ClusterId{value='681d77dc80e48e12eb254b19', description='null'}-localhost:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, cryptd=false, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=19973625, minRoundTripTimeNanos=0}
2025-05-09T09:04:52.928+05:30  INFO 39313 --- [grpc] [main] o.s.b.web.embedded.netty.NettyWebServer  : Netty started on port 8009 (http)
2025-05-09T09:04:52.944+05:30  INFO 39313 --- [grpc] [main] o.s.grpc.server.NettyGrpcServerFactory   : Registered gRPC service: stocktrading.StockTradingService
2025-05-09T09:04:52.944+05:30  INFO 39313 --- [grpc] [main] o.s.grpc.server.NettyGrpcServerFactory   : Registered gRPC service: grpc.reflection.v1.ServerReflection
2025-05-09T09:04:52.944+05:30  INFO 39313 --- [grpc] [main] o.s.grpc.server.NettyGrpcServerFactory   : Registered gRPC service: grpc.health.v1.Health
2025-05-09T09:04:52.952+05:30  INFO 39313 --- [grpc] [main] o.s.g.s.lifecycle.GrpcServerLifecycle    : gRPC Server started, listening on address: [/[0:0:0:0:0:0:0:0]:9090]
2025-05-09T09:04:52.961+05:30  INFO 39313 --- [grpc] [main] com.grpc.GrpcApplication                 : Started GrpcApplication in 1.013 seconds (process running for 1.171)
2025-05-09T09:04:59.813+05:30  WARN 39313 --- [grpc] [grpc-default-executor-0] io.grpc.internal.ServerCallImpl          : Cancelling the stream because of internal error

io.grpc.StatusRuntimeException: INTERNAL: Completed without a response
	at io.grpc.Status.asRuntimeException(Status.java:524) ~[grpc-api-1.72.0.jar:1.72.0]
	at io.grpc.internal.ServerCallImpl.closeInternal(ServerCallImpl.java:223) ~[grpc-core-1.72.0.jar:1.72.0]
	at io.grpc.internal.ServerCallImpl.close(ServerCallImpl.java:213) ~[grpc-core-1.72.0.jar:1.72.0]
	at io.grpc.stub.ServerCalls$ServerCallStreamObserverImpl.onCompleted(ServerCalls.java:396) ~[grpc-stub-1.72.0.jar:1.72.0]
	at com.grpc.service.StockTradingServiceImpl.getStockPrice(StockTradingServiceImpl.java:39) ~[classes/:na]
	at com.grpc.StockTradingServiceGrpc$MethodHandlers.invoke(StockTradingServiceGrpc.java:261) ~[classes/:na]
	at io.grpc.stub.ServerCalls$UnaryServerCallHandler$UnaryServerCallListener.onHalfClose(ServerCalls.java:182) ~[grpc-stub-1.72.0.jar:1.72.0]
	at io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.halfClosed(ServerCallImpl.java:356) ~[grpc-core-1.72.0.jar:1.72.0]
	at io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1HalfClosed.runInContext(ServerImpl.java:861) ~[grpc-core-1.72.0.jar:1.72.0]
	at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37) ~[grpc-core-1.72.0.jar:1.72.0]
	at io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133) ~[grpc-core-1.72.0.jar:1.72.0]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:1575) ~[na:na]

2025-05-09T09:06:03.294+05:30  INFO 39313 --- [grpc] [SpringApplicationShutdownHook] o.s.g.s.lifecycle.GrpcServerLifecycle    : Completed gRPC server shutdown
2025-05-09T09:06:03.295+05:30  INFO 39313 --- [grpc] [SpringApplicationShutdownHook] o.s.b.w.embedded.netty.GracefulShutdown  : Commencing graceful shutdown. Waiting for active requests to complete
2025-05-09T09:06:03.296+05:30  INFO 39313 --- [grpc] [netty-shutdown] o.s.b.w.embedded.netty.GracefulShutdown  : Graceful shutdown complete
2025-05-09T09:06:23.478+05:30  INFO 39327 --- [grpc] [main] com.grpc.GrpcApplication                 : Starting GrpcApplication using Java 23.0.2 with PID 39327 (/Users/rishabhsharma/Downloads/grpc/target/classes started by rishabhsharma in /Users/rishabhsharma/Downloads/grpc)
2025-05-09T09:06:23.479+05:30  INFO 39327 --- [grpc] [main] com.grpc.GrpcApplication                 : No active profile set, falling back to 1 default profile: "default"
2025-05-09T09:06:23.690+05:30  INFO 39327 --- [grpc] [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Reactive MongoDB repositories in DEFAULT mode.
2025-05-09T09:06:23.750+05:30  INFO 39327 --- [grpc] [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 58 ms. Found 1 Reactive MongoDB repository interface.
2025-05-09T09:06:23.939+05:30  INFO 39327 --- [grpc] [main] org.mongodb.driver.client                : MongoClient with metadata {"driver": {"name": "mongo-java-driver|reactive-streams|spring-boot", "version": "5.2.1"}, "os": {"type": "Darwin", "name": "Mac OS X", "architecture": "aarch64", "version": "15.4.1"}, "platform": "Java/Amazon.com Inc./23.0.2+7-FR"} created with settings MongoClientSettings{readPreference=primary, writeConcern=WriteConcern{w=null, wTimeout=null ms, journal=null}, retryWrites=true, retryReads=true, readConcern=ReadConcern{level=null}, credential=null, transportSettings=NettyTransportSettings{eventLoopGroup=io.netty.channel.nio.NioEventLoopGroup@5261ec9, socketChannelClass=null, allocator=null, sslContext=null}, commandListeners=[], codecRegistry=ProvidersCodecRegistry{codecProviders=[ValueCodecProvider{}, BsonValueCodecProvider{}, DBRefCodecProvider{}, DBObjectCodecProvider{}, DocumentCodecProvider{}, CollectionCodecProvider{}, IterableCodecProvider{}, MapCodecProvider{}, GeoJsonCodecProvider{}, GridFSFileCodecProvider{}, Jsr310CodecProvider{}, JsonObjectCodecProvider{}, BsonCodecProvider{}, EnumCodecProvider{}, com.mongodb.client.model.mql.ExpressionCodecProvider@65bb6275, com.mongodb.Jep395RecordCodecProvider@64da6cbd, com.mongodb.KotlinCodecProvider@72a2312e]}, loggerSettings=LoggerSettings{maxDocumentLength=1000}, clusterSettings={hosts=[localhost:27017], srvServiceName=mongodb, mode=SINGLE, requiredClusterType=UNKNOWN, requiredReplicaSetName='null', serverSelector='null', clusterListeners='[]', serverSelectionTimeout='30000 ms', localThreshold='15 ms'}, socketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=0, receiveBufferSize=0, proxySettings=ProxySettings{host=null, port=null, username=null, password=null}}, heartbeatSocketSettings=SocketSettings{connectTimeoutMS=10000, readTimeoutMS=10000, receiveBufferSize=0, proxySettings=ProxySettings{host=null, port=null, username=null, password=null}}, connectionPoolSettings=ConnectionPoolSettings{maxSize=100, minSize=0, maxWaitTimeMS=120000, maxConnectionLifeTimeMS=0, maxConnectionIdleTimeMS=0, maintenanceInitialDelayMS=0, maintenanceFrequencyMS=60000, connectionPoolListeners=[], maxConnecting=2}, serverSettings=ServerSettings{heartbeatFrequencyMS=10000, minHeartbeatFrequencyMS=500, serverMonitoringMode=AUTO, serverListeners='[]', serverMonitorListeners='[]'}, sslSettings=SslSettings{enabled=false, invalidHostNameAllowed=false, context=null}, applicationName='null', compressorList=[], uuidRepresentation=JAVA_LEGACY, serverApi=null, autoEncryptionSettings=null, dnsClient=null, inetAddressResolver=null, contextProvider=null, timeoutMS=null}
2025-05-09T09:06:23.969+05:30  INFO 39327 --- [grpc] [cluster-ClusterId{value='681d7837b29f7866b8f00fa5', description='null'}-localhost:27017] org.mongodb.driver.cluster               : Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, cryptd=false, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=17, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=30, roundTripTimeNanos=14391250, minRoundTripTimeNanos=0}
2025-05-09T09:06:24.211+05:30  INFO 39327 --- [grpc] [main] o.s.b.web.embedded.netty.NettyWebServer  : Netty started on port 8009 (http)
2025-05-09T09:06:24.228+05:30  INFO 39327 --- [grpc] [main] o.s.grpc.server.NettyGrpcServerFactory   : Registered gRPC service: stocktrading.StockTradingService
2025-05-09T09:06:24.228+05:30  INFO 39327 --- [grpc] [main] o.s.grpc.server.NettyGrpcServerFactory   : Registered gRPC service: grpc.reflection.v1.ServerReflection
2025-05-09T09:06:24.228+05:30  INFO 39327 --- [grpc] [main] o.s.grpc.server.NettyGrpcServerFactory   : Registered gRPC service: grpc.health.v1.Health
2025-05-09T09:06:24.234+05:30  INFO 39327 --- [grpc] [main] o.s.g.s.lifecycle.GrpcServerLifecycle    : gRPC Server started, listening on address: [/[0:0:0:0:0:0:0:0]:9090]
2025-05-09T09:06:24.242+05:30  INFO 39327 --- [grpc] [main] com.grpc.GrpcApplication                 : Started GrpcApplication in 0.964 seconds (process running for 1.116)
2025-05-09T15:14:11.509+05:30  INFO 39327 --- [grpc] [SpringApplicationShutdownHook] o.s.g.s.lifecycle.GrpcServerLifecycle    : Completed gRPC server shutdown
2025-05-09T15:14:11.511+05:30  INFO 39327 --- [grpc] [SpringApplicationShutdownHook] o.s.b.w.embedded.netty.GracefulShutdown  : Commencing graceful shutdown. Waiting for active requests to complete
2025-05-09T15:14:11.513+05:30  INFO 39327 --- [grpc] [netty-shutdown] o.s.b.w.embedded.netty.GracefulShutdown  : Graceful shutdown complete
